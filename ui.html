<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="stylesheet" type="text/css" href="css/style.css">
	</head>
  <body>
    <div>
			<div id="generate-button-container">
			</div>
			<div style="display: flex;">
				<button style="border-radius: 6px;height: 28px; width: 28px;border: none;">ä¸‰</button>
				<button style="border-radius: 6px;height: 28px; width: 28px;border: none;">{ }</button>
			</div>
			<button class="bg-primary-500 text-surface-invert"
				style="border-radius: 8px;height: 36px;padding-left: 16px;padding-right: 16px;border: none;"
			>
				Generate
			</button>
      <ul id="variables-collection">
      </ul>
      <div id="color-variables">
      </div>
    </div>
  </body>
  <script type="module">
		// const generateButton = document.querySelector('#generate-button');
		// const generateButton = Button({label: 'Generate'});
    window.onmessage = (event) => {
      const { name, content } = event.data.pluginMessage;
      console.log(content);
      if (name === "get-variable-collections") {
				const { collections } = content;
        const list = document.querySelector("#variables-collection");
        list.innerHTML = "";
        collections.forEach(({ name, id, variableIds }) => {
          const li = document.createElement("li");
          li.textContent = name;
          li.setAttribute("id", `collection-${id}`);
          li.onclick = () => {
            parent.postMessage(
              {
                pluginMessage: {
                  type: "get-variable-group",
                  id,
                  variableIds
                },
              },
              "*"
            );
          };
          list.appendChild(li);
        });
      } else if (name === 'get-collection-variables') {
				const { variables } = content;
        const colorVariablesDiv = document.querySelector("#color-variables");
        colorVariablesDiv.innerHTML = "";
        variables.forEach(({ name, valuesByMode }) => {
          const div = document.createElement("div");
          div.textContent = `${name}: value`;
          colorVariablesDiv.appendChild(div);
        });
      }
			if (name === "create-element") {
				const { tag, attribute, children, parentElement } = content;
				console.log(tag, attribute, children);

				const element = document.createElement(tag);

				if (children) {
					element.innerHTML = children;
				}

				if (!!(attribute && Object.keys(attribute).length)) {
					for (const [key, value] of Object.entries(attribute)) {
						if (key === "style") {
							for (const [styleKey, styleValue] of Object.entries(value)) {
								element.style[styleKey] = styleValue;
							}
						} else if (typeof value === "string") {
							element.setAttribute(key, value);
						}
					}
				}

				// Mount to parent element
				let parent;
				if (parentElement) {
					parent = document.querySelector(parentElement);
				}
				parent.appendChild(element);
			}
    };

  </script>
</html>
